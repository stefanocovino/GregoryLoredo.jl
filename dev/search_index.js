var documenterSearchIndex = {"docs":
[{"location":"Example/","page":"Example","title":"Example","text":"using CairoMakie\nusing Downloads: download\nusing Format\nusing GregoryLoredo\nusing ZipStreams","category":"page"},{"location":"Example/#A-real-life-example-of-the-Gregory-and-Loredo-(1992)-algorithm","page":"Example","title":"A real life example of the Gregory & Loredo (1992) algorithm","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"This example of application of the GL92 algorithm is based on data published by Raywade et al.(2020). The Authors collected fast-radio bursts (FRBs) from the event FRB 121102 in order to identify a possible periodicity in the occurrence these events.","category":"page"},{"location":"Example/#Download-the-dataset","page":"Example","title":"Download the dataset","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"First of all, let's download the table with the events selected in this study. It is available as supplemental material at the site of the journal.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"url = \"https://oup.silverchair-cdn.com/oup/backfile/Content_public/Journal/mnras/495/4/10.1093_mnras_staa1237/1/staa1237_supplemental_files.zip?Expires=1766572517&Signature=adGzR1A9rTR87jcRkYgNoTttES089LNZfiERXSlFMe7PXiETHLtRVleSsvn8CXCEbRFdcPqTq30FYJkocKHpV11yZ395ny1j4zIvYP5uXRrZ47vqtyNw2lF0uHlQPtGL3PI0yFF0kjLEBNcVpfVs1igA753JRkIocmyrjdodoY03mBOVcvlv44riSBgEjLba5Jv-YgpfCnuq2J2NkDlh~N-GWM8QZu3frI4IhlMbbC69hai8Q9a4hc6OTHh1T7pqYcx-q78JT5tZBRWUUjeUU~cBl44OjZsALEFrYS4wyoQxVqunw9LX8ti-sTNCvn4QCb42cqWtw8KsqiXAikYR9Q__&Key-Pair-Id=APKAIE5G5CRDK6RD3PGA\"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"data = Vector{Float64}()\n\nzipsource(download(url)) do source   # context management of sources with \"do\" syntax\n    for f in source                  # iterate through files in an archive\n        println(info(f).name)\n        if info(f).name == \"All_dets_paper.txt\"\n            open(info(f).name) do fdt\n                l = readlines(fdt)\n                for i in l\n                    push!(data,parse(Float64,split(i)[2]))\n                end\n            end\n        end\n    end\nend","category":"page"},{"location":"Example/#Visualize-the-dataset","page":"Example","title":"Visualize the dataset","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Let's plot an histogram showing the FRB detection epoch distribution in our dataset.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"f = Figure()\n\nax = Axis(f[1,1],\n    xlabel = \"Time (MJD)\",\n    ylabel = \"N\",\n    )\n\nhist!(data)\n\nf","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: Histogram)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"println(\"Data consists of \", length(data), \" events.\")","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Data consists of 234 events.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"We need to define a frequency range for the analysis. We can provide a range defined manually, or rely on an automatic generation baased on data length and range. We can have a linear or logarithmic spacing.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"wr = FrequencyRange(data,logspacing=true)\n\nwhi = maximum(wr)\nwlo = minimum(wr)\n\nprintfmtln(\"Minimum period: {:.1f} days, maximum period: {:.1f} days, number of periods: {:d}\",2π/whi,2π/wlo,length(wr))","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Minimum period: 10.7 days, maximum period: 250.3 days, number of periods: 117","category":"page"},{"location":"Example/#Model-parameter","page":"Example","title":"Model parameter","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"The GL92 does not assume any specific light-curve shape, and descfribe the variability pattern as a box-shaped function. The maximum number of boxes is, in principle, only limited by the availabke conputing power and data quality. For the dataset we are considering, we adopt a maximum number of boxes of 40.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"mmax = 40;","category":"page"},{"location":"Example/#Odd-ratios","page":"Example","title":"Odd ratios","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"The first step is therefore to compute the odd ratios for each model (m from 2 to mmax) compared to the constant (no variability model, m=1).","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"omq = OddRatios(data,wr,mmax);","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"And plot the histogram of the obtained odd ratios:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"PlotOddRatios(omq);","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: Histogram)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"And derive some summary from the odd ratios distribution:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"odrs = OddRatioSummary(omq)\nprintfmtln(\"Probability non-constant model: {:.2g} and best number of bins: {:d}\", odrs.prob, odrs.maxm)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Probability non-constant model: 1.00 and best number of bins: 17","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"First of all, the probability for a non-constant model is extrenely high, and apart from the simplest caes with low m, the most probable models require m in the range approximately from 6 to 30. The highest probability is for m=17. Of course, pay attention to the logarithm scale of the plot.","category":"page"},{"location":"Example/#Periodogram-for-the-best-m","page":"Example","title":"Periodogram for the best m","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Let's therefore compute and plot a periodogram for this choice of m:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"mper = Periodogram(data,wr,odrs.maxm)\nPlotPeriodogram(mper,wr);","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: Histogram)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"And let's derive some information from the periodogram data:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"mpers = PeriodogramSummary(mper,wr)\nprintfmtln(\"Log maximum power: {:.2f}, angular frequency at maximum: {:.3f}, period: {:.2f} days\",log10(mpers.maxpow),mpers.maxfreq,mpers.maxper)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Log maximum power: 4.20, angular frequency at maximum: 0.040, period: 157.69 days","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"The periodogram indeed shows a rather promiment peak at the period = 157.69 days. This is in reasonable agreement with what reported in Raywade et al.(2020), although based on different tools. It is also of interest comparing our periodogram with what reported in their paper, in Fig. 3.","category":"page"},{"location":"Example/#Light-curve-shape","page":"Example","title":"Light-curve shape","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Having derived the most probable frequency for a periodic behaviour, we can compute and plot the light-curve shape:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"llpl = LightCurveShape(wr,odrs.maxm,data);\nPlotLightCurve(llpl)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: Histogram)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"And again we can compare it with the analogous plot in Raywade et al.(2020), i.e., their Fig. 4. The two light-curves are very similar but now the phase is not assumed, it is just comnputed from the data.","category":"page"},{"location":"Example/#Marginalized-periodogram","page":"Example","title":"Marginalized periodogram","text":"","category":"section"},{"location":"Example/","page":"Example","title":"Example","text":"","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Finally, rather than choosing the most probable m, it is also possible, and probably better justified, computing a periodogram marginalizing for m. Results are often very similar, specially if the most probable m stands clearly out the general distribution. But this is not always the case.","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"The marginalized periodogram can be computed and plotted with:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"marmper = MarginalizedPeriodogram(data,wr,mmax)\nPlotPeriodogram(marmper,wr);","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"(Image: Histogram)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"And the usual summary:","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"marmpers = PeriodogramSummary(marmper,wr)\nprintfmtln(\"Log maximum power: {:.2f}, angular frequency at maximum: {:.3f}, period: {:.2f}\",log10(marmpers.maxpow),marmpers.maxfreq,marmpers.maxper)","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"Log maximum power: 1.56, angular frequency at maximum: 0.029, period: 218.49 days","category":"page"},{"location":"Example/","page":"Example","title":"Example","text":"As a matter of fact, the peak at \\sim 157 days is still there, but a new peak at \\sim 218 days appears. Both peaks are now less promiment, possibly suggesting that the identified periodicity is not (basing upon the available data) very solid.","category":"page"},{"location":"","page":"Home","title":"Home","text":"CurrentModule = GregoryLoredo","category":"page"},{"location":"#GregoryLoredo","page":"Home","title":"GregoryLoredo","text":"","category":"section"},{"location":"","page":"Home","title":"Home","text":"Documentation for GregoryLoredo.","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"","category":"page"},{"location":"","page":"Home","title":"Home","text":"Modules = [GregoryLoredo]","category":"page"},{"location":"#GregoryLoredo.lcshape","page":"Home","title":"GregoryLoredo.lcshape","text":"lcshape\n\nFields\n\nμlc: Vector of rate mean value for each bin\nσlc: Vector of standard deviation for the rate for each bin\n\n\n\n\n\n","category":"type"},{"location":"#GregoryLoredo.orsum","page":"Home","title":"GregoryLoredo.orsum","text":"orsum\n\nFields\n\nprob: Vector of probabilities for each possible bin number m\nmaxm: Bin number showing the maximum probability\n\n\n\n\n\n","category":"type"},{"location":"#GregoryLoredo.persum","page":"Home","title":"GregoryLoredo.persum","text":"persum\n\nFields\n\nmaxpow: Maximum power in the periodogram\nmaxfreq: Frequency at the maximum power\nmaxper: Period at the maximum power\n\n\n\n\n\n","category":"type"},{"location":"#GregoryLoredo.BinMult-Tuple{Vector{Int64}}","page":"Home","title":"GregoryLoredo.BinMult","text":"BinMult(nbins::Vector{Int})\n\n#Arguments\n\nnbins is a vector with the number of events for each bin.\n\nCompute the basic factor for the multiplicity of the binned events (Eq. 1.4 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.BinningFactor-Tuple{Float64, Float64, Int64, Vector{Float64}}","page":"Home","title":"GregoryLoredo.BinningFactor","text":"BinningFactor(ω::Float64,Φ::Float64,m::Int,tlist::Vector{Float64})::BigFloat\n\n#Arguments\n\nω is the angular frequency.\nΦ is the phase.\nm is the number of bins.\ntlist is the vector of arrival times.\n\nCompute the binning factor (Eq. B4 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.ComputeBinValues-Tuple{Int64, Float64, Float64, Vector{Float64}}","page":"Home","title":"GregoryLoredo.ComputeBinValues","text":"ComputeBinValues(m::Int,ω::Float64,Φ::Float64,tlist::Vector{Float64})\n\n#Arguments\n\nm is the number of bins.\nω is the angular frequency.\nΦ is the phase.\ntlist is the vector of arrival times.\n\nCompute the number of events falling in each bin of a model with m bins with given frequency and phase.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.FrequencyRange-Tuple{Vector{Float64}}","page":"Home","title":"GregoryLoredo.FrequencyRange","text":"FrequencyRange(Tlist::Vector{Float64};tstart=minimum(Tlist),tend=maximum(Tlist),logspacing=false))\n\n#Arguments\n\nTlist is the vector of arrival times.\ntstart is the minimum possible arrival time (default to the minimum of Tlist)\ntend is the minimum possible arrival time (default to the maximum of Tlist)\nlogspacing generates a log-spaced frquency range.\n\nCompute the frequency range to be analysed accordiong to the advises in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.FullBinMult-Tuple{Vector{Int64}}","page":"Home","title":"GregoryLoredo.FullBinMult","text":"FullBinMult(nbins::Vector{Int})\n\n#Arguments\n\nnbins is a vector with the number of events for each bin.\n\nCompute the full multiplicity of the binned events (Eq. 1.4 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.FullBinMultLog-Tuple{Vector{Int64}}","page":"Home","title":"GregoryLoredo.FullBinMultLog","text":"FullBinMultLog(nbins::Vector{Int})\n\n#Arguments\n\nnbins is a vector with the number of events for each bin.\n\nCompute the full multiplicity of the binned events (Eq. 1.4 in Gregory & Lorendo (1992)).\n\nThe computation is here carried out by the logarithm.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.LightCurveShape-Tuple{Vector{Float64}, Int64, Vector{Float64}}","page":"Home","title":"GregoryLoredo.LightCurveShape","text":"LightCurveShape(ωr::Vector{Float64},m::Int,tlist::Vector{Float64};unc=false,progress=false,phasesteps=10)::lcshape\n\n#Arguments\n\nωr is the vector of the analyzed frequencies.\nm is the number of bins.\ntlist is the vector of arrival times.\nunc computes light-curve uncertainty if selected.\nprogress shows progress bars if selected.\n\nCompute the light curve shape given the number m of bins and the input arrival time tlist (Eq. 7.10 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.LightCurveSimpleShape-Tuple{Float64, Float64, Int64, Vector{Float64}}","page":"Home","title":"GregoryLoredo.LightCurveSimpleShape","text":"LightCurveSimpleShape(ω::Float64,Φ::Float64,m::Int,tlist::Vector{Float64};unc=false)::lcshape\n\n#Arguments\n\nω is the angular frequency.\nΦ is the phase.\nm is the number of bins.\ntlist is the vector of arrival times.\nunc computes light-curve uncertainty if selected.\n\nCompute the light curve shape given the angular frequency ω, the phase Φ, m bins given the input arrival time tlist (Eq. 4.3 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.MarginalizedPeriodogram-Tuple{Vector{Float64}, Vector{Float64}, Int64}","page":"Home","title":"GregoryLoredo.MarginalizedPeriodogram","text":"MarginalizedPeriodogram(Tlist::Vector{Float64},ωr::Vector{Float64};progress=false,phasesteps=10)\n\n#Arguments\n\nTlist is the vector of arrival times.\nωr is the vector of the analyzed frequencies.\nmmax is the maximum number of bins.\nprogress shows progress bars if selected.\n\nCompute the periodogram following Section 6 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.OddRatioSummary-Tuple{Vector{BigFloat}}","page":"Home","title":"GregoryLoredo.OddRatioSummary","text":"OddRatioSummary(or::Vector{Real})::orsum\n\n#Arguments\n\nod is the vector of computed odd ratios for each considered light-curve bin number.\n\nCompute the probability for a non constant model Eq. 5.2. in Gregory & Lorendo (1992)) and the bin number yileding the highest odd-ratio.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.OddRatios-Tuple{Vector{Float64}, Vector{Float64}, Int64}","page":"Home","title":"GregoryLoredo.OddRatios","text":"OddRatios(Tlist::Vector{Float64},ωr::Vector{Float64},mmax::Int;progress=false,phasesteps=10)\n\n#Arguments\n\nTlist is the vector of arrival times.\nωr is the vector of the analyzed frequencies.\nmmax is the maximum number of bins.\nprogress shows progress bars if selected.\n\nCompute the odd ratio following Appendix A in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.Periodogram","page":"Home","title":"GregoryLoredo.Periodogram","text":"Periodogram(Tlist::Vector{Float64},ωr::Vector{Float64},m::Int,phasesteps=10)\n\n#Arguments\n\nTlist is the vector of arrival times.\nωr is the vector of the analyzed frequencies.\nm is the number of bins.\n\nCompute the periodogram following Section 6 in Gregory & Lorendo (1992)).\n\n\n\n\n\n","category":"function"},{"location":"#GregoryLoredo.PeriodogramSummary-Tuple{Vector{BigFloat}, Vector{Float64}}","page":"Home","title":"GregoryLoredo.PeriodogramSummary","text":"PeriodogramSummary(per::Vector{BigFloat},ωr::Vector{Float64})::persum\n\n#Arguments\n\nper is the vector of powers for each considered frequency.\nωr is the vector of the analyzed frequencies.\n\nPlot the Odd Ratio as a function of the number of bins.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.PlotLightCurve-Tuple{GregoryLoredo.lcshape}","page":"Home","title":"GregoryLoredo.PlotLightCurve","text":"PlotLightCurve(lpl::lcshape;xlabel=\"\",ylabel=\"\",sigma=1.)\n\n#Arguments\n\nlpl is a light-curve shape structure.\nxlabel is the (optional) label for the x-axis.\nylabel is the (optional) label for the y-axis.\nsigma is the number od standard deviation to be plotted.\n\nPlot the light-curve in the given bins of the analysis.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.PlotOddRatios-Tuple{Vector{BigFloat}}","page":"Home","title":"GregoryLoredo.PlotOddRatios","text":"PlotOddRatios(or::Vector{Real};xlabel=\"\",ylabel=\"\";xlabel=\"\",ylabel=\"\")\n\n#Arguments\n\nod is the vector of computed odd ratios for each considered light-curve bin number.\nxlabel is the (optional) label for the x-axis.\nylabel is the (optional) label for the y-axis.\n\nPlot the oddratio for each possible bin number.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.PlotPeriodogram-Tuple{Vector{BigFloat}, Vector{Float64}}","page":"Home","title":"GregoryLoredo.PlotPeriodogram","text":"PlotPeriodogram(per::Vector{BigFloat},ωr::Vector{Float64};xlabel=\"\",ylabel=\"\",pmax=2π/minimum(ωr),pmin=2π/maximum(ωr))\n\n#Arguments\n\nper is the vector of powers for each considered frequency.\nωr is the vector of the analyzed frequencies.\nxlabel is the (optional) label for the x-axis.\nylabel is the (optional) label for the y-axis.\npmin is the minimum of the plotted periods (default minimum of the input data).\npmax is the maximum of the plotted periods (default maximum of the input data).\n\nPlot the periodogram as a function of the analysed frequencies.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.WeightingFactor-Tuple{Vector{Int64}, Int64, Int64}","page":"Home","title":"GregoryLoredo.WeightingFactor","text":"WeightingFactor(njbin::Vector{Int},m::Int,totcnt::Int)::Vector{BigFloat}\n\n#Arguments\n\nnjbin is the vector with the number of events in each model bin.\nm is the number of bins for the adopted model.\ntotcnt is the total number of events in the analyzed dataset.\n\nCompute the weighting factors for each bin of the model.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.jt-Tuple{Int64, Float64, Float64, Float64}","page":"Home","title":"GregoryLoredo.jt","text":"jt(m::Int,ω::Float64,Φ::Float64,t::Float64)\n\n#Arguments\n\nm is the number of bins.\nω is the angular frequency.\nΦ is the phase.\nt is the time.\n\nCompute the bin number at time tfor a model with m bins with given frequency and phase.\n\n\n\n\n\n","category":"method"},{"location":"#GregoryLoredo.logStirlingApprox-Tuple{Int64}","page":"Home","title":"GregoryLoredo.logStirlingApprox","text":"logStirlingApprox(n::Int)\n\n#Arguments\n\nn is the integer we want to use to compute the factorial.\n\n\n\n\n\n","category":"method"}]
}
